/*
 * jquery.YAPSM.js
 *
 * Copyright 2011, Kjel Delaey (https://github.com/trimentor/YAPSM)
 * https://github.com/trimentor/YAPSM/blob/master/LICENSE
 */
(function(a){a.extend(a.fn,{yapsm:function(c){var d=new a.yapsm(c);var b=function(){this.complexity=d.strength(this.value)};a(this).keyup(b);return this}});a.yapsm=function(b){this.settings=a.extend({},a.yapsm.defaults,b);this.entropyMap=a.extend({},a.yapsm.entropyMap);this.field=a(this);this.init()};a.extend(a.yapsm,{defaults:{fieldClass:"yapsm",shortClass:"too-short",weakClass:"weak",fairClass:"fair",goodClass:"good",strongClass:"strong",veryStrongClass:"very-strong",commonWordClass:"dictionary-word"},entropyMap:{decimal:{count:10,entropy:3.32},hexadecimal:{count:16,entropy:4},mixedCaseLettersOnly:{count:26,entropy:4.7},mixedCaseLettersAndNumbers:{count:36,entropy:5.17},caseSensitiveLettersOnly:{count:52,entropy:5.7},caseSensitiveLettersAndNumbers:{count:62,entropy:5.95},otherCharacters:{count:1,entropy:6.55}},prototype:{init:function(){this.commonWords(this.settings.dictionary)},commonWords:function(d){var c;var b=typeof(d);if(b=="function"){c=d()}else{if(b=="object"){c=d}else{c=new Array()}}this.dictionary=c},strength:function(b){var c=this.commonWord(b);var d=!c?this.passwordStrength(b):null;return this.strengthClass(d)},charSetEntropy:function(b){return Math.log(b)/Math.log(2)},passwordStrength:function(b){var c=this.numberOfPossibleSymbols(b);return this.charSetEntropy(c)*b.length},commonWord:function(c){var f=c.toLowerCase();var e=false;for(var d=0;d<this.dictionary.length;d++){var b=this.dictionary[d].toLowerCase();if(f==b){e=true;break}}return e},numberOfPossibleSymbols:function(c){var e;var h=0;var j,f,g,b;for(var d=0;d<c.length;d++){e=c.charAt(d);if(typeof(j)=="undefined"&&/[0-9]/.test(e)){j=true;h+=this.entropyMap.decimal.count}if(typeof(g)=="undefined"&&/[A-Z]/.test(e)){g=true;h+=this.entropyMap.mixedCaseLettersOnly.count}if(typeof(f)=="undefined"&&/[a-z]/.test(e)){f=true;h+=this.entropyMap.mixedCaseLettersOnly.count}if(typeof(b)=="undefined"&&"`~-_=+[{]}\\|;:'\",<.>/?!@#$%^&*()".indexOf(e)>=0){b=true;h+=this.entropyMap.otherCharacters.count}}return h},strengthClass:function(c){var b;if(c==null){b=this.settings.commonWordClass}else{if(c>=28&&c<=35){b=this.settings.fairClass}else{if(c>=36&&c<=59){b=this.settings.goodClass}else{if(c>=60&&c<=127){b=this.settings.strongClass}else{if(c>=128){b=this.settings.veryStrongClass}else{b=this.settings.weakClass}}}}}return b},passwordGuesses:function(c,d){var b=!!d?c-1:c;return Math.pow(2,b)},timeToGuess:function(d){var c=Math.pow(10,9)*3;var b=Math.floor(d)/c;return[b,b*60,b*3600]}}})})(jQuery);